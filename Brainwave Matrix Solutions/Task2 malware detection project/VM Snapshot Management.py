import subprocess
import datetime

def take_snapshot():
    snapshot_name = f"pre_analysis_{datetime.datetime.now().strftime('%Y%m%d_%H%M%S')}"
    result = subprocess.run([
        "VBoxManage", "snapshot", "MalwareSandbox", "take", snapshot_name,
        "--description", "Pre-analysis snapshot"
    ], capture_output=True, text=True)
    
    if result.returncode == 0:
        print(f"Snapshot '{snapshot_name}' created successfully")
        return snapshot_name
    else:
        print(f"Error creating snapshot: {result.stderr}")
        return None

def restore_snapshot(snapshot_name):
    result = subprocess.run([
        "VBoxManage", "snapshot", "MalwareSandbox", "restore", snapshot_name
    ], capture_output=True, text=True)
    
    if result.returncode == 0:
        print(f"Restored to snapshot '{snapshot_name}'")
        return True
    else:
        print(f"Error restoring snapshot: {result.stderr}")
        return False
